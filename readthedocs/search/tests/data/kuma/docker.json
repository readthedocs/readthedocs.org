{
  "content": "kuma-Docker Docker is used for development and (soon) for deployment.\nDocker Images\nDocker images are used in development, usually with the local working files mounted in the images to set behaviour.\nImages are built by Jenkins, after tests pass, and are published to quay.io. We try to store the configuration in the environment, so that the published images can be used in deployments by setting environment variables to deployment-specific values.\nHere are some of the images used in the Kuma project:\nkuma\nThe kuma Docker image builds on the kuma_base image, installing a kuma branch and building the assets needed for running as a webservice. The environment can be customized for different deployments.\nThe image can be recreated locally with make build-kuma.\nThe image tagged latest is used by default for development. It can be created locally with make build-kuma VERSION=latest. The  latest image is created from the master branch in Jenkins and published to quay.io.\nkuma_base\nThe kuma_base Docker image contains the OS and libraries (C, Python, and Node.js) that support the kuma project. The kuma image extends this by installing the kuma source and building assets needed for production.\nThe image can be recreated locally with make build-base.\nThe image tagged latest is used by default for development. It can be created localled with make build-base VERSION=latest. The  latest image is created from the master branch in Jenkins and published to quay.io\nkumascript\nThe kumascript Docker image contains the kumascript rendering engine and support files. The environment can be customized for different deployments.\nThe image can be recreated locally with make build-kumascript.\nThe image tagged latest is used by default for development. It can be created locally with make build-kumascript KS_VERSION=latest. The  latest image is created from the master branch in Jenkins and published to quay.io.\nintegration-tests\nThe integration-tests Docker image contains browser-based integration tests that check the functionality of a running Kuma deployment.\nThe image can be recreated locally with docker build -f docker/images/integration-tests/ ., but this is only necessary for image development. Most developer will follow the Client-side testing  to develop and run these integration tests.\nThe image is built and used in Jenkins in the stage-integration-tests and prod-integration-tests pipelines, configured by scripts in the Jenkinsfiles folder. It is not published to quay.io.",
  "headers": [
    "Docker",
    "Docker Images",
    "kuma",
    "kuma_base",
    "kumascript",
    "integration-tests"
  ],
  "title": "Docker",
  "sections": [
    {
      "content": "\n<a class=\"reference external\" href=\"https://www.docker.com\">Docker</a> is used for development and (soon) for deployment.\n",
      "id": "docker",
      "title": "Docker"
    },
    {
      "content": "\n<h2>Docker Images<a class=\"headerlink\" href=\"#docker-images\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>Docker images are used in development, usually with the local\nworking files mounted in the images to set behaviour.</p>\n<p>Images are built by <a class=\"reference external\" href=\"https://ci.us-west.moz.works\">Jenkins</a>, after tests pass, and are\npublished to <a class=\"reference external\" href=\"https://quay.io/repository/mozmar/kuma\">quay.io</a>.  We try to\n<a class=\"reference external\" href=\"https://12factor.net/config\">store the configuration in the environment</a>, so that the\npublished images can be used in deployments by setting\nenvironment variables to deployment-specific values.</p>\n<p>Here are some of the images used in the Kuma project:</p>\n<div class=\"section\" id=\"kuma\">\n<h3>kuma<a class=\"headerlink\" href=\"#kuma\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>The kuma Docker image builds on the kuma_base image, installing a kuma branch\nand building the assets needed for running as a webservice.  The environment\ncan be customized for different deployments.</p>\n<p>The image can be recreated locally with <code class=\"docutils literal notranslate\"><span class=\"pre\">make</span> <span class=\"pre\">build-kuma</span></code>.</p>\n<p>The image tagged <code class=\"docutils literal notranslate\"><span class=\"pre\">latest</span></code> is used by default for development. It can be\ncreated locally with <code class=\"docutils literal notranslate\"><span class=\"pre\">make</span> <span class=\"pre\">build-kuma</span> <span class=\"pre\">VERSION=latest</span></code>. The  latest\nimage is created from the master branch in <a class=\"reference external\" href=\"https://ci.us-west.moz.works/blue/organizations/jenkins/mdn_multibranch_pipeline/branches/\">Jenkins</a> and published to\n<a class=\"reference external\" href=\"https://quay.io/repository/mozmar/kuma_base\">quay.io</a>.</p>\n</div>\n<div class=\"section\" id=\"kuma-base\">\n<h3>kuma_base<a class=\"headerlink\" href=\"#kuma-base\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>The kuma_base Docker image contains the OS and libraries (C, Python, and\nNode.js) that support the kuma project.  The kuma image extends this by\ninstalling the kuma source and building assets needed for production.</p>\n<p>The image can be recreated locally with <code class=\"docutils literal notranslate\"><span class=\"pre\">make</span> <span class=\"pre\">build-base</span></code>.</p>\n<p>The image tagged <code class=\"docutils literal notranslate\"><span class=\"pre\">latest</span></code> is used by default for development. It can be\ncreated localled with <code class=\"docutils literal notranslate\"><span class=\"pre\">make</span> <span class=\"pre\">build-base</span> <span class=\"pre\">VERSION=latest</span></code>. The \nlatest image is created from the master branch in <a class=\"reference external\" href=\"https://ci.us-west.moz.works/blue/organizations/jenkins/mdn_multibranch_pipeline/branches/\">Jenkins</a> and published to\n<a class=\"reference external\" href=\"https://quay.io/repository/mozmar/kuma_base\">quay.io</a></p>\n</div>\n<div class=\"section\" id=\"kumascript\">\n<h3>kumascript<a class=\"headerlink\" href=\"#kumascript\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>The kumascript Docker image contains the kumascript rendering engine and\nsupport files.  The environment can be customized for different deployments.</p>\n<p>The image can be recreated locally with <code class=\"docutils literal notranslate\"><span class=\"pre\">make</span> <span class=\"pre\">build-kumascript</span></code>.</p>\n<p>The image tagged <code class=\"docutils literal notranslate\"><span class=\"pre\">latest</span></code> is used by default for development. It can be\ncreated locally with <code class=\"docutils literal notranslate\"><span class=\"pre\">make</span> <span class=\"pre\">build-kumascript</span> <span class=\"pre\">KS_VERSION=latest</span></code>. The \nlatest image is created from the master branch in <a class=\"reference external\" href=\"https://ci.us-west.moz.works/blue/organizations/jenkins/mdn_multibranch_pipeline/branches/\">Jenkins</a> and published to\n<a class=\"reference external\" href=\"https://quay.io/repository/mozmar/kumascript\">quay.io</a>.</p>\n</div>\n<div class=\"section\" id=\"integration-tests\">\n<h3>integration-tests<a class=\"headerlink\" href=\"#integration-tests\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>The integration-tests Docker image contains browser-based integration tests\nthat check the functionality of a running Kuma deployment.</p>\n<p>The image can be recreated locally with\n<code class=\"docutils literal notranslate\"><span class=\"pre\">docker</span> <span class=\"pre\">build</span> <span class=\"pre\">-f</span> <span class=\"pre\">docker/images/integration-tests/</span> <span class=\"pre\">.</span></code>, but this is only\nnecessary for image development. Most developer will follow the\n<a class=\"reference external\" href=\"https://kuma.readthedocs.io/en/latest/tests-ui.html\">Client-side testing </a> to develop and run these integration tests.</p>\n<p>The image is built and used in <a class=\"reference external\" href=\"https://ci.us-west.moz.works/blue/organizations/jenkins/mdn_multibranch_pipeline/activity\">Jenkins</a> in the <code class=\"docutils literal notranslate\"><span class=\"pre\">stage-integration-tests</span></code> and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">prod-integration-tests</span></code> pipelines, configured by scripts in the\n<code class=\"docutils literal notranslate\"><span class=\"pre\">Jenkinsfiles</span></code> folder.  It is not published to quay.io.</p>\n</div>\n",
      "id": "docker-images",
      "title": "Docker Images"
    }
  ],
  "path": "docker"
}