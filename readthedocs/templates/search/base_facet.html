{% extends 'base.html' %}
{% load highlight %}
{% load pagination_tags %}

{% block title %} Search: {{ query }} {% endblock %}

{% block content %}

  <!-- BEGIN search form -->
  <div class="wide-search-bar">
    <div class="wide-search-bar-wrapper clearfix">
      <form action="." method="GET">
        <div class="text-input-wrapper">
          <input type="text" name="q" value="{{ query }}" autocomplete="off" id="id_site_search_2">
          <input type="hidden" name="selected_facets" value="{{ selected_facets }}" id='id_selected_facets'>
        </div>
        <div class="submit-input-wrapper">
          <input type="submit" value="Go crazy." id="id_search_button">
        </div>
      </form>
    </div>
  </div>
  <!-- END search form -->


  <!-- BEGIN search results -->
  <div class="module">
    <div class="module-wrapper">

      <div class="module-header">
        <h3 id="id_search_title">{% if query %}{{ count }} Results for {{ query }}{% else %}No search term entered{% endif %}</h3>
      </div>

      {% block faceting %}{% endblock %}
  
      <div class="module-list">
        <div class="module-list-wrapper">
          <ul id="id_search_result">
          {% if query %}
             {% autopaginate results 10 %}
             {% for result in results %}
              <li class="module-item">
              {% ifequal result.model_name 'project' %}
                <p class="module-item-title">
                  Project:
                  <a href="{% if result.absolute_url %}{{ result.absolute_url }}{% else %}{{ result.object.get_absolute_url }}{% endif %}">{{ result.title }} - {{ result.author }}</a>
                </p>
                {% else %}
                <p class="module-item-title">
                  File:
                  <a href="{% if result.absolute_url %}{{ result.absolute_url }}{% else %}{{ result.object.get_absolute_url }}{% endif %}?highlight={{ query }}">{{ result.project }} - {{ result.title }}</a>
                </p>
                <p>
                  {% highlight result.text with query %}
                </p>
                {% endifequal %}
              </li>
            {% empty %}
              <li class="module-item"><span class="quiet">No results found. Bummer.</span></li>
            {% endfor %}  
          {% endif %}
          </ul>
        </div>
      </div>

    </div>
  </div>
  <!-- END search results -->

  {% paginate %}

{% endblock %}
