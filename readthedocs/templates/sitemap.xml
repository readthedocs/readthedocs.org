<?xml version="1.0" encoding="UTF-8"?>

{# First byte needs to be opening tag in XML #}
{% load static from static %}

{# Use template for human readable version and informational content #}
<?xml-stylesheet type="text/xml" href="{% static "/core/xsl/sitemap.xslt" %}"?>

{% comment %}
  Sitemaps don't have a shared top level entity so we can only show one of these at a time:

  - A ``sitemapindex`` pointing to other sitemaps
  - A ``urlset`` pointing to URLs for project public versions

  The view handles how to show one list or the other.
{% endcomment %}

{% if sitemaps %}
  <sitemapindex xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
    {% for sitemap in sitemaps %}
      <sitemap>
        <loc>{{ sitemap.loc }}</loc>
        {% if sitemap.lastmod %}
          <lastmod>{{ sitemap.lastmod }}</lastmod>
        {% endif %}
      </sitemap>
    {% endfor %}
  </sitemapindex>
{% elif versions %}
  <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
          xmlns:xhtml="http://www.w3.org/1999/xhtml">
    {% for version in versions %}
      <url>
        <loc>{{ version.loc }}</loc>
        {% for language in version.languages %}
          <xhtml:link
              rel="alternate"
              hreflang="{{ language.hreflang }}"
              href="{{ language.href }}"/>
        {% endfor %}
        {% if version.lastmod %}
          <lastmod>{{ version.lastmod }}</lastmod>
        {% endif %}
        <changefreq>{{ version.changefreq }}</changefreq>
        <priority>{{ version.priority }}</priority>
      </url>
    {% endfor %}
  </urlset>
{% endif %}
