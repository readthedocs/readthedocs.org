require=function n(i,o,a){function c(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=o[t]={exports:{}},i[t][0].call(r.exports,function(e){return c(i[t][1][e]||e)},r,r.exports,n,i,o,a)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)c(a[e]);return c}({1:[function(e,t,r){!function(){var c,n,u,e,t,r,i,o,a,l,s,p,h,f,d,v,m,y,g,_,b,w,C,x=[].slice,k=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1},T=window.jQuery||window.Zepto||window.$;T.payment={},T.payment.fn={},T.fn.payment=function(){var e=arguments[0],t=2<=arguments.length?x.call(arguments,1):[];return T.payment.fn[e].apply(this,t)},e=/(\d{1,4})/g,T.payment.cards=u=[{type:"visaelectron",patterns:[4026,417500,4405,4508,4844,4913,4917],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",patterns:[5018,502,503,506,56,58,639,6220,67],format:e,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",patterns:[600],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",patterns:[5019],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"visa",patterns:[4],format:e,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:e,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",patterns:[62,88],format:e,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",patterns:[35],format:e,length:[16],cvcLength:[3],luhn:!0}],c=function(e){var t,r,n,i,o,a,c;for(e=(e+"").replace(/\D/g,""),n=0,o=u.length;n<o;n++)for(i=0,a=(c=(t=u[n]).patterns).length;i<a;i++)if(r=c[i]+"",e.substr(0,r.length)===r)return t},n=function(e){for(var t,r=0,n=u.length;r<n;r++)if((t=u[r]).type===e)return t},p=function(e){for(var t,r=!0,n=0,i=(e+"").split("").reverse(),o=0,a=i.length;o<a;o++)t=i[o],t=parseInt(t,10),(r=!r)&&(t*=2),9<t&&(t-=9),n+=t;return n%10==0},s=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")||!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)},w=function(e,t){var r,n,i;try{r=t.prop("selectionStart")}catch(e){r=null}if(n=t.val(),t.val(e),null!==r&&t.is(":focus"))return r===n.length&&(r=e.length),n!==e&&(i=n.slice(r-1,+r+1||9e9),n=e.slice(r-1,+r+1||9e9),e=e[r],/\d/.test(e)&&i===e+" "&&n===" "+e&&(r+=1)),t.prop("selectionStart",r),t.prop("selectionEnd",r)},m=function(e){for(var t,r,n,i="",o=0,a=(t=(e=null==e?"":e).split("")).length;o<a;o++)r=t[o],i+=r=-1<(n="０１２３４５６７８９".indexOf(r))?"0123456789"[n]:r;return i},v=function(e){var t=T(e.currentTarget);return setTimeout(function(){var e=t.val();return e=(e=m(e)).replace(/\D/g,""),w(e,t)})},f=function(e){var t=T(e.currentTarget);return setTimeout(function(){var e=t.val();return e=m(e),e=T.payment.formatCardNumber(e),w(e,t)})},i=function(e){var t,r,n,i,o,a=String.fromCharCode(e.which);if(/^\d+$/.test(a)&&(t=T(e.currentTarget),o=t.val(),n=c(o+a),r=(o.replace(/\D/g,"")+a).length,i=16,n&&(i=n.length[n.length.length-1]),!(i<=r||null!=t.prop("selectionStart")&&t.prop("selectionStart")!==o.length)))return(n=n&&"amex"===n.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(o)?(e.preventDefault(),setTimeout(function(){return t.val(o+" "+a)})):n.test(o+a)?(e.preventDefault(),setTimeout(function(){return t.val(o+a+" ")})):void 0},t=function(e){var t=T(e.currentTarget),r=t.val();if(8===e.which&&(null==t.prop("selectionStart")||t.prop("selectionStart")===r.length))return/\d\s$/.test(r)?(e.preventDefault(),setTimeout(function(){return t.val(r.replace(/\d\s$/,""))})):/\s\d?$/.test(r)?(e.preventDefault(),setTimeout(function(){return t.val(r.replace(/\d$/,""))})):void 0},d=function(e){var t=T(e.currentTarget);return setTimeout(function(){var e=t.val();return e=m(e),e=T.payment.formatExpiry(e),w(e,t)})},o=function(e){var r,n,t=String.fromCharCode(e.which);if(/^\d+$/.test(t))return r=T(e.currentTarget),n=r.val()+t,/^\d$/.test(n)&&"0"!==n&&"1"!==n?(e.preventDefault(),setTimeout(function(){return r.val("0"+n+" / ")})):/^\d\d$/.test(n)?(e.preventDefault(),setTimeout(function(){var e=parseInt(n[0],10),t=parseInt(n[1],10);return 2<t&&0!==e?r.val("0"+e+" / "+t):r.val(n+" / ")})):void 0},a=function(e){var t=String.fromCharCode(e.which);if(/^\d+$/.test(t))return e=(t=T(e.currentTarget)).val(),/^\d\d$/.test(e)?t.val(e+" / "):void 0},l=function(e){var t=String.fromCharCode(e.which);if("/"===t||" "===t)return e=(t=T(e.currentTarget)).val(),/^\d$/.test(e)&&"0"!==e?t.val("0"+e+" / "):void 0},r=function(e){var t=T(e.currentTarget),r=t.val();if(8===e.which&&(null==t.prop("selectionStart")||t.prop("selectionStart")===r.length))return/\d\s\/\s$/.test(r)?(e.preventDefault(),setTimeout(function(){return t.val(r.replace(/\d\s\/\s$/,""))})):void 0},h=function(e){var t=T(e.currentTarget);return setTimeout(function(){var e=t.val();return e=(e=m(e)).replace(/\D/g,"").slice(0,4),w(e,t)})},b=function(e){return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(e=String.fromCharCode(e.which),!!/[\d\s]/.test(e))))},g=function(e){var t=T(e.currentTarget),e=String.fromCharCode(e.which);if(/^\d+$/.test(e)&&!s(t))return t=(t.val()+e).replace(/\D/g,""),(e=c(t))?t.length<=e.length[e.length.length-1]:t.length<=16},_=function(e){var t=T(e.currentTarget),e=String.fromCharCode(e.which);if(/^\d+$/.test(e)&&!s(t))return!(6<(t.val()+e).replace(/\D/g,"").length)&&void 0},y=function(e){var t=T(e.currentTarget),e=String.fromCharCode(e.which);if(/^\d+$/.test(e)&&!s(t))return(t.val()+e).length<=4},C=function(e){var n,t=T(e.currentTarget),r=t.val(),e=T.payment.cardType(r)||"unknown";if(!t.hasClass(e))return r=function(){for(var e=[],t=0,r=u.length;t<r;t++)n=u[t],e.push(n.type);return e}(),t.removeClass("unknown"),t.removeClass(r.join(" ")),t.addClass(e),t.toggleClass("identified","unknown"!==e),t.trigger("payment.cardType",e)},T.payment.fn.formatCardCVC=function(){return this.on("keypress",b),this.on("keypress",y),this.on("paste",h),this.on("change",h),this.on("input",h),this},T.payment.fn.formatCardExpiry=function(){return this.on("keypress",b),this.on("keypress",_),this.on("keypress",o),this.on("keypress",l),this.on("keypress",a),this.on("keydown",r),this.on("change",d),this.on("input",d),this},T.payment.fn.formatCardNumber=function(){return this.on("keypress",b),this.on("keypress",g),this.on("keypress",i),this.on("keydown",t),this.on("keyup",C),this.on("paste",f),this.on("change",f),this.on("input",f),this.on("input",C),this},T.payment.fn.restrictNumeric=function(){return this.on("keypress",b),this.on("paste",v),this.on("change",v),this.on("input",v),this},T.payment.fn.cardExpiryVal=function(){return T.payment.cardExpiryVal(T(this).val())},T.payment.cardExpiryVal=function(e){var t=e.split(/[\s\/]+/,2),e=t[0],t=t[1];return 2===(null!=t?t.length:void 0)&&/^\d+$/.test(t)&&(t=(new Date).getFullYear().toString().slice(0,2)+t),{month:e=parseInt(e,10),year:t=parseInt(t,10)}},T.payment.validateCardNumber=function(e){var t,r;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(t=c(e))&&(r=e.length,0<=k.call(t.length,r)&&(!1===t.luhn||p(e))))},T.payment.validateCardExpiry=function(e,t){var r;return"object"==typeof e&&"month"in e&&(e=(r=e).month,t=r.year),!(!e||!t)&&(e=T.trim(e),t=T.trim(t),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(t)&&(1<=e&&e<=12&&(4===(t=2===t.length?t<70?"20"+t:"19"+t:t).length&&(t=new Date(t,e),e=new Date,t.setMonth(t.getMonth()-1),t.setMonth(t.getMonth()+1,1),e<t)))))},T.payment.validateCardCVC=function(e,t){var r;return e=T.trim(e),!!/^\d+$/.test(e)&&(null!=(r=n(t))?(t=e.length,0<=k.call(r.cvcLength,t)):3<=e.length&&e.length<=4)},T.payment.cardType=function(e){return e&&(null!=(e=c(e))?e.type:void 0)||null},T.payment.formatCardNumber=function(e){var t,r;return e=e.replace(/\D/g,""),(t=c(e))?(r=t.length[t.length.length-1],e=e.slice(0,r),t.format.global?null!=(r=e.match(t.format))?r.join(" "):void 0:null!=(t=t.format.exec(e))?(t.shift(),(t=T.grep(t,function(e){return e})).join(" ")):void 0):e},T.payment.formatExpiry=function(e){var t,r=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/);return r?(t=r[1]||"",e=r[2]||"",0<(r=r[3]||"").length?e=" / ":" /"===e?(t=t.substring(0,1),e=""):2===t.length||0<e.length?e=" / ":1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,e=" / "),t+e+r):""}}.call(this)},{}],2:[function(e,t,r){var n=e("knockout"),i=(e("./../../../../../bower_components/jquery.payment/lib/jquery.payment.js"),e("jquery")),o=null;function a(e){var r=this,e=e||{};o.publishableKey=r.stripe_key=e.key,r.form=e.form,r.cc_number=n.observable(null),r.cc_expiry=n.observable(null),r.cc_cvv=n.observable(null),r.error_cc_number=n.observable(null),r.error_cc_expiry=n.observable(null),r.error_cc_cvv=n.observable(null),r.stripe_token=n.observable(null),r.last_4_card_digits=n.observable(null),r.is_editing_card=n.observable(!1),r.show_card_form=n.computed(function(){return r.is_editing_card()||!r.last_4_card_digits()||r.cc_number()||r.cc_expiry()||r.cc_cvv()}),r.initialize_form(),r.error=n.observable(null),r.process_form=function(){var e=i.payment.cardExpiryVal(r.cc_expiry()),e={number:r.cc_number(),exp_month:e.month,exp_year:e.year,cvc:r.cc_cvv()};return r.error(null),r.error_cc_number(null),r.error_cc_expiry(null),r.error_cc_cvv(null),i.payment.validateCardNumber(e.number)?i.payment.validateCardExpiry(e.exp_month,e.exp_year)?i.payment.validateCardCVC(e.cvc)?void o.createToken(e,function(e,t){t.error?"card_error"==t.error.type?({invalid_number:r.error_cc_number,incorrect_number:r.error_cc_number,expired_card:r.error_cc_number,card_declined:r.error_cc_number,invalid_expiry_month:r.error_cc_expiry,invalid_expiry_year:r.error_cc_expiry,invalid_cvc:r.error_cc_cvv,incorrect_cvc:r.error_cc_cvv}[t.error.code]||r.error_cc_number)(t.error.message):r.error_cc_number(t.error.message):r.submit_form(t.card.last4,t.id)}):(r.error_cc_cvv("Invalid security code"),!1):(r.error_cc_expiry("Invalid expiration date"),!1):(r.error_cc_number("Invalid card number"),!1)},r.process_full_form=function(){if(!r.show_card_form())return!0;r.process_form()}}"undefined"!=typeof window&&void 0!==window.Stripe&&(o=window.Stripe||{}),n.bindingHandlers.valueInit={init:function(e,t){t=t();n.isWriteableObservable(t)&&t(e.value)}},a.prototype.submit_form=function(e,t){this.form.find("#id_last_4_card_digits").val(e),this.form.find("#id_stripe_token").val(t),this.form.find("#id_cc_number").val(null),this.form.find("#id_cc_expiry").val(null),this.form.find("#id_cc_cvv").val(null),this.form.submit()},a.prototype.initialize_form=function(){var e=i("input#id_cc_number"),t=i("input#id_cc_cvv"),r=i("input#id_cc_expiry");e.payment("formatCardNumber"),r.payment("formatCardExpiry"),t.payment("formatCardCVC"),e.trigger("keyup")},a.init=function(e,t){e=new a(e),t=t||i("#payment-form")[0];return n.applyBindings(e,t),e},t.exports.PaymentView=a},{"./../../../../../bower_components/jquery.payment/lib/jquery.payment.js":1,jquery:"jquery",knockout:"knockout"}],"gold/gold":[function(e,t,r){e("jquery");var n=e("readthedocs/payments/static-src/payments/js/base"),i=e("knockout");function o(e){e=e||{};this.constructor.call(this,e),this.last_4_card_digits=i.observable(null)}o.prototype=new n.PaymentView,o.init=function(e,t){e=new o(e),t=t||$("#payment-form")[0];return i.applyBindings(e,t),e},t.exports.GoldView=o},{jquery:"jquery",knockout:"knockout","readthedocs/payments/static-src/payments/js/base":2}]},{},[]);